
<!-- This script is the one that takes the entry clicked on and relays the information into the modal -->
<script>
  $('#clusterDetail').on('show.bs.modal', function (event) {
    let trigger = $(event.relatedTarget)
    let clusterName = trigger.data('clustername')
    let taskdef = trigger.data('taskdef')
    let imagetag = trigger.data('imagetag')
    let revision = trigger.data('revision')
    let date = trigger.data('date')
    let cpu = trigger.data('cpu')
    let memory = trigger.data('memory')
    let modal = $(this)
    modal.find('.cluster-title').text(clusterName)
    modal.find('.taskdef').text(taskdef)
    modal.find('.imagetag').text(imagetag)
    modal.find('.revision').text(revision)
    modal.find('.date').text(date)
    modal.find('.cpu').text(cpu)
    modal.find('.memory').text(memory)
  })
</script>

<style>
  div.modal-header {
    padding: 10px; 10px;
    padding-bottom: 3px
  }
</style>
<!-- This is the modal and it is working with the function above to create multiple unique modal's based on which entry was pressed. -->
<div class="modal fade bd-example-modal-lg" id="clusterDetail" tabindex="-1" role="dialog" aria-labelledby="clusterLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="cluster-title" id="clusterLabel"></h3>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="cluster-info">
        <table class="table table-striped">
          <thead>
            <tr>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th scope="row">Task Definition</th>
              <td class="taskdef"></td>
            </tr>
            <tr>
              <th scope="row">Image Tag</th>
              <td class="imagetag"></td>
            </tr>
            <tr>
              <th scope="row">Revision</th>
              <td class="revision"></td>
            </tr>
            <tr>
              <th scope="row">Date</th>
              <td class="date"></td>
            </tr>
            <tr>
              <th scope="row">CPU</th>
              <td class="cpu"></td>
            </tr>
            <tr>
              <th scope="row">Memory</th>
              <td class="memory"></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<table class="table table-hover table-striped">
  <thead>
    <tr>
      <th scope="col">Client</th>
      <th scope="col">Product</th>
      <th scope="col">Release #</th>
      <th scope="col">Cluster</th>
      <th scope="col">Environment</th>
      <th scope="col">Region</th>
    </tr>
  </thead>
  <tbody>

<!-- This is a for loop to render the search results  -->
    {% for query in results %}
    {% for result in query %}

    <tr
      data-toggle="modal"
      data-target="#clusterDetail"
      data-clustername="{{result.cluster_name}}"
      data-taskdef="{{result.task_definition_name}}"
      data-imagetag="{{result.image_tag}}"
      data-revision="{{result.revision}}"
      data-date="{{result.date}}"
      data-cpu="{{result.cpu}}"
      data-memory="{{result.memory}}"
      >
      <th scope="row">{{result.client_name}}</th>
      <td> {{result.product_name}} </td>
      <td> {{result.release}} </td>
      <td> {{result.cluster_name}} </td>
      <td> {{result.environment}} </td>
      <td> {{result.region}} </td>
    </tr>

    {% endfor %}
    {% endfor %}
  </tbody>
</table>
